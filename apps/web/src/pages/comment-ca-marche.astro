---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Icon from '../components/Icon.astro';
import { t } from '../i18n/utils';

const locale = 'fr' as const;

const consumerSteps = [
  { img: '/images/illustrations/vitrine-etape-1-cherche.png', title: t(locale, 'howItWorks.consumerStep1Title'), desc: t(locale, 'howItWorks.consumerStep1Desc') },
  { img: '/images/illustrations/vitrine-etape-2-reserve.png', title: t(locale, 'howItWorks.consumerStep2Title'), desc: t(locale, 'howItWorks.consumerStep2Desc') },
  { img: '/images/illustrations/vitrine-etape-3-retire.png', title: t(locale, 'howItWorks.consumerStep3Title'), desc: t(locale, 'howItWorks.consumerStep3Desc') },
  { img: null, title: t(locale, 'howItWorks.consumerStep4Title'), desc: t(locale, 'howItWorks.consumerStep4Desc') },
];

const partnerSteps = [
  { iconName: 'Store' as const, title: t(locale, 'howItWorks.partnerStep1Title'), desc: t(locale, 'howItWorks.partnerStep1Desc') },
  { iconName: 'ClipboardList' as const, title: t(locale, 'howItWorks.partnerStep2Title'), desc: t(locale, 'howItWorks.partnerStep2Desc') },
  { iconName: 'Smartphone' as const, title: t(locale, 'howItWorks.partnerStep3Title'), desc: t(locale, 'howItWorks.partnerStep3Desc') },
  { iconName: 'Banknote' as const, title: t(locale, 'howItWorks.partnerStep4Title'), desc: t(locale, 'howItWorks.partnerStep4Desc') },
];
---

<BaseLayout
  title="Comment ça marche — BienBon"
  description="Découvrez comment BienBon fonctionne pour les consommateurs et les commerçants partenaires à l'île Maurice."
  locale={locale}
  canonicalPath="/comment-ca-marche"
>
  <Header locale={locale} currentPath="/comment-ca-marche" />
  <main id="main-content">
    <!-- Page header -->
    <section class="bg-gradient-to-br from-green-100 to-neutral-50 py-14 sm:py-20">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h1 class="text-4xl sm:text-5xl font-extrabold text-neutral-900">
          {t(locale, 'howItWorks.title')}
        </h1>
        <p class="mt-4 text-lg text-neutral-600 max-w-xl mx-auto">
          Simple, rapide et responsable — pour les consommateurs comme pour les commerçants.
        </p>
      </div>
    </section>

    <!-- Consumer section -->
    <section class="py-16 sm:py-20 bg-white" aria-labelledby="consumer-heading">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center gap-3 mb-10">
          <Icon name="Users" size={28} class="text-green-700 flex-shrink-0" />
          <h2 id="consumer-heading" class="text-2xl sm:text-3xl font-extrabold text-neutral-900">
            {t(locale, 'howItWorks.consumerTitle')}
          </h2>
        </div>

        <ol class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
          {consumerSteps.map((step, i) => (
            <li class="relative">
              <!-- Connector line -->
              {i < consumerSteps.length - 1 && (
                <div class="hidden lg:block absolute top-8 left-full w-full h-0.5 bg-green-100 z-0" aria-hidden="true"></div>
              )}

              <div class="relative z-10 flex flex-col items-center text-center">
                <div class="w-16 h-16 rounded-xl bg-green-100 flex items-center justify-center mb-4 overflow-hidden" aria-hidden="true">
                  {step.img ? (
                    <img src={step.img} alt="" class="w-full h-full object-contain p-1" />
                  ) : (
                    <Icon name="UtensilsCrossed" size={32} class="text-green-700" />
                  )}
                </div>
                <div class="text-xs font-black text-green-700 mb-1 tracking-widest">
                  Étape {i + 1}
                </div>
                <h3 class="text-base font-extrabold text-neutral-900 mb-2">{step.title}</h3>
                <p class="text-sm text-neutral-600 leading-relaxed">{step.desc}</p>
              </div>
            </li>
          ))}
        </ol>
      </div>
    </section>

    <!-- Partner section -->
    <section class="py-16 sm:py-20 bg-neutral-50" aria-labelledby="partner-heading">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center gap-3 mb-10">
          <Icon name="Store" size={28} class="text-orange-600 flex-shrink-0" />
          <h2 id="partner-heading" class="text-2xl sm:text-3xl font-extrabold text-neutral-900">
            {t(locale, 'howItWorks.partnerTitle')}
          </h2>
        </div>

        <ol class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
          {partnerSteps.map((step, i) => (
            <li class="flex flex-col items-center text-center">
              <div class="w-16 h-16 rounded-xl bg-orange-100 flex items-center justify-center mb-4 overflow-hidden" aria-hidden="true">
                <Icon name={step.iconName} size={32} class="text-orange-600" />
              </div>
              <div class="text-xs font-black text-orange-600 mb-1 tracking-widest">
                Étape {i + 1}
              </div>
              <h3 class="text-base font-extrabold text-neutral-900 mb-2">{step.title}</h3>
              <p class="text-sm text-neutral-600 leading-relaxed">{step.desc}</p>
            </li>
          ))}
        </ol>
      </div>
    </section>

    <!-- CTA -->
    <section class="py-16 bg-green-700 text-center">
      <div class="max-w-xl mx-auto px-4">
        <h2 class="text-2xl sm:text-3xl font-extrabold text-white mb-4">
          Prêt à commencer ?
        </h2>
        <div class="flex flex-col sm:flex-row justify-center gap-4">
          <a
            href="#app-download"
            class="inline-flex items-center justify-center px-6 py-4 rounded-lg bg-white text-green-700 font-bold hover:bg-green-100 transition-colors min-h-[52px]"
          >
            Télécharger l'app
          </a>
          <a
            href="/devenir-partenaire"
            class="inline-flex items-center justify-center px-6 py-4 rounded-lg border-2 border-white text-white font-bold hover:bg-green-600 transition-colors min-h-[52px]"
          >
            Devenir partenaire
          </a>
        </div>
      </div>
    </section>
  </main>
  <Footer locale={locale} />
</BaseLayout>
